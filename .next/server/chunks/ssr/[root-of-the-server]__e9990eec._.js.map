{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 37, "column": 0}, "map": {"version":3,"sources":["file:///D:/university/project/AstroZangli-AI/AstroZangli-AI/frontend/src/components/FooterBar.tsx"],"sourcesContent":["\"use client\";\n\nimport Image from \"next/image\";\nimport Link from \"next/link\";\nimport { usePathname } from \"next/navigation\";\nimport React, { useState, useEffect } from \"react\";\n\n// 定义导航项类型\ninterface NavItem {\n  href: string;\n  icon: string;\n}\n\n// 自适应 hook - 修复：初始化时立即获取真实窗口宽度\nfunction useWindowWidth(): number {\n  const [width, setWidth] = useState<number>(() => {\n    // 在客户端初始化时立即获取真实窗口宽度\n    if (typeof window !== 'undefined') {\n      return window.innerWidth;\n    }\n    return 390; // 服务端渲染时的默认值\n  });\n\n  useEffect(() => {\n    // 客户端挂载时再次确认宽度（处理初始化时机问题）\n    setWidth(window.innerWidth);\n\n    function handleResize(): void {\n      setWidth(window.innerWidth);\n    }\n\n    window.addEventListener(\"resize\", handleResize);\n\n    return () => window.removeEventListener(\"resize\", handleResize);\n  }, []);\n\n  return width;\n}\n\nexport default function FooterBar(): React.JSX.Element {\n  const pathname = usePathname();\n  const width = useWindowWidth();\n\n  // 按 390px 基准做比例\n  const scale: number = width / 390;\n  const iconSize: number = 18.5 * scale; // 图标大小\n  const footerHeight: number = 51 * scale; // 整个 footer 高度\n\n  const navItems: NavItem[] = [\n    { href: \"/cal\", icon: \"/cond/cal.png\" },\n    { href: \"/earth\", icon: \"/cond/globe.png\" },\n    { href: \"/chat\", icon: \"/cond/chat.png\" },\n    { href: \"/docs\", icon: \"/cond/book.png\" },\n    { href: \"/user\", icon: \"/cond/user.png\" },\n  ];\n\n  return (\n    <div\n      className=\"bg-gray-900/80 glass-effect border-t border-gray-700\"\n      style={{ height: footerHeight }}\n    >\n      <div className=\"flex justify-around items-center max-w-md mx-auto h-full\">\n        {navItems.map((item: NavItem, idx: number) => {\n          const isActive: boolean = pathname === item.href;\n\n          // 中间\"聊天\"按钮突出显示\n          if (idx === 2) {\n            return (\n              // <Link\n              //       href=\"/chat\"\n              //       className=\"flex flex-col items-center space-y-1 p-2 rounded-lg transition-colors text-white\"\n              //       style={{\n              //           backgroundColor: \"#0051feff\",  // 始终使用这个背景色\n              //       }}\n              //   >\n              //       <Image src=\"/cond/chat.png\" alt=\"聊天\" width={24} height={24} />\n              //       <span className=\"text-xs\">聊天</span>\n              //   </Link>\n              <Link\n                href={item.href}\n                key={item.href}\n                className={`flex items-center justify-center rounded-full transition-colors shadow-lg \n    bg-[#0051feff]`}\n                style={{\n                  padding: 10 * scale,\n                  transform: `translateY(-${footerHeight * 0.2}px)`,\n                }}\n              >\n                <Image\n                  src={item.icon}\n                  alt=\"\"\n                  width={iconSize * 1.2}\n                  height={iconSize * 1.2}\n                  style={{ width: `${iconSize * 1.2}px`, height: `${iconSize * 1.2}px` }}\n                />\n              </Link>\n\n            );\n          }\n\n          // 其他项\n          return (\n            <Link\n              href={item.href}\n              key={item.href}\n              className={`flex items-center justify-center rounded-lg transition-colors\n                ${isActive ? \"bg-gray-700\" : \"hover:bg-gray-700\"}`}\n              style={{ padding: 6 * scale }}\n            >\n              <Image\n                src={item.icon}\n                alt=\"\"\n                width={iconSize}\n                height={iconSize}\n                style={{ width: `${iconSize}px`, height: `${iconSize}px` }}\n              />\n            </Link>\n          );\n        })}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AALA;;;;;;AAaA,+BAA+B;AAC/B,SAAS;IACP,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAU;QACzC,qBAAqB;QACrB;;QAGA,OAAO,KAAK,aAAa;IAC3B;IAEA,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,0BAA0B;QAC1B,SAAS,OAAO,UAAU;QAE1B,SAAS;YACP,SAAS,OAAO,UAAU;QAC5B;QAEA,OAAO,gBAAgB,CAAC,UAAU;QAElC,OAAO,IAAM,OAAO,mBAAmB,CAAC,UAAU;IACpD,GAAG,EAAE;IAEL,OAAO;AACT;AAEe,SAAS;IACtB,MAAM,WAAW,CAAA,GAAA,kIAAA,CAAA,cAAW,AAAD;IAC3B,MAAM,QAAQ;IAEd,gBAAgB;IAChB,MAAM,QAAgB,QAAQ;IAC9B,MAAM,WAAmB,OAAO,OAAO,OAAO;IAC9C,MAAM,eAAuB,KAAK,OAAO,eAAe;IAExD,MAAM,WAAsB;QAC1B;YAAE,MAAM;YAAQ,MAAM;QAAgB;QACtC;YAAE,MAAM;YAAU,MAAM;QAAkB;QAC1C;YAAE,MAAM;YAAS,MAAM;QAAiB;QACxC;YAAE,MAAM;YAAS,MAAM;QAAiB;QACxC;YAAE,MAAM;YAAS,MAAM;QAAiB;KACzC;IAED,qBACE,8OAAC;QACC,WAAU;QACV,OAAO;YAAE,QAAQ;QAAa;kBAE9B,cAAA,8OAAC;YAAI,WAAU;sBACZ,SAAS,GAAG,CAAC,CAAC,MAAe;gBAC5B,MAAM,WAAoB,aAAa,KAAK,IAAI;gBAEhD,eAAe;gBACf,IAAI,QAAQ,GAAG;oBACb,OACE,QAAQ;oBACR,qBAAqB;oBACrB,qGAAqG;oBACrG,iBAAiB;oBACjB,wDAAwD;oBACxD,WAAW;oBACX,MAAM;oBACN,uEAAuE;oBACvE,4CAA4C;oBAC5C,YAAY;kCACZ,8OAAC,4JAAA,CAAA,UAAI;wBACH,MAAM,KAAK,IAAI;wBAEf,WAAW,CAAC;kBACV,CAAC;wBACH,OAAO;4BACL,SAAS,KAAK;4BACd,WAAW,CAAC,YAAY,EAAE,eAAe,IAAI,GAAG,CAAC;wBACnD;kCAEA,cAAA,8OAAC,6HAAA,CAAA,UAAK;4BACJ,KAAK,KAAK,IAAI;4BACd,KAAI;4BACJ,OAAO,WAAW;4BAClB,QAAQ,WAAW;4BACnB,OAAO;gCAAE,OAAO,GAAG,WAAW,IAAI,EAAE,CAAC;gCAAE,QAAQ,GAAG,WAAW,IAAI,EAAE,CAAC;4BAAC;;;;;;uBAblE,KAAK,IAAI;;;;;gBAkBpB;gBAEA,MAAM;gBACN,qBACE,8OAAC,4JAAA,CAAA,UAAI;oBACH,MAAM,KAAK,IAAI;oBAEf,WAAW,CAAC;gBACV,EAAE,WAAW,gBAAgB,qBAAqB;oBACpD,OAAO;wBAAE,SAAS,IAAI;oBAAM;8BAE5B,cAAA,8OAAC,6HAAA,CAAA,UAAK;wBACJ,KAAK,KAAK,IAAI;wBACd,KAAI;wBACJ,OAAO;wBACP,QAAQ;wBACR,OAAO;4BAAE,OAAO,GAAG,SAAS,EAAE,CAAC;4BAAE,QAAQ,GAAG,SAAS,EAAE,CAAC;wBAAC;;;;;;mBAVtD,KAAK,IAAI;;;;;YAcpB;;;;;;;;;;;AAIR","debugId":null}},
    {"offset": {"line": 191, "column": 0}, "map": {"version":3,"sources":["file:///D:/university/project/AstroZangli-AI/AstroZangli-AI/frontend/src/services/chatApi.ts"],"sourcesContent":["export interface ChatApiResponse {\r\n    success: boolean;\r\n    data?: {\r\n        reply: string;\r\n    };\r\n    error?: {\r\n        message: string;\r\n    };\r\n}\r\n\r\n// The API base is the root of our own application, not the external API\r\nconst API_BASE = \"/api\";\r\n\r\nexport async function fetchChatReply(message: string): Promise<ChatApiResponse[\"data\"]> {\r\n    const res = await fetch(`${API_BASE}/chat`, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ message }),\r\n    });\r\n\r\n    if (!res.ok) {\r\n        // Attempt to parse error response for a more specific message\r\n        const errorJson = await res.json().catch(() => ({}));\r\n        const errorMessage = errorJson.error?.message || `HTTP error! status: ${res.status}`;\r\n        throw new Error(errorMessage);\r\n    }\r\n\r\n    const json: ChatApiResponse = await res.json();\r\n\r\n    if (!json.success) {\r\n        throw new Error(json.error?.message || \"请求失败\");\r\n    }\r\n\r\n    return json.data;\r\n}\r\n"],"names":[],"mappings":";;;AAUA,wEAAwE;AACxE,MAAM,WAAW;AAEV,eAAe,eAAe,OAAe;IAChD,MAAM,MAAM,MAAM,MAAM,GAAG,SAAS,KAAK,CAAC,EAAE;QACxC,QAAQ;QACR,SAAS;YAAE,gBAAgB;QAAmB;QAC9C,MAAM,KAAK,SAAS,CAAC;YAAE;QAAQ;IACnC;IAEA,IAAI,CAAC,IAAI,EAAE,EAAE;QACT,8DAA8D;QAC9D,MAAM,YAAY,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;QAClD,MAAM,eAAe,UAAU,KAAK,EAAE,WAAW,CAAC,oBAAoB,EAAE,IAAI,MAAM,EAAE;QACpF,MAAM,IAAI,MAAM;IACpB;IAEA,MAAM,OAAwB,MAAM,IAAI,IAAI;IAE5C,IAAI,CAAC,KAAK,OAAO,EAAE;QACf,MAAM,IAAI,MAAM,KAAK,KAAK,EAAE,WAAW;IAC3C;IAEA,OAAO,KAAK,IAAI;AACpB","debugId":null}},
    {"offset": {"line": 222, "column": 0}, "map": {"version":3,"sources":["file:///D:/university/project/AstroZangli-AI/AstroZangli-AI/frontend/src/app/chat/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport Link from \"next/link\";\nimport FooterBar from \"@/components/FooterBar\";\nimport { fetchChatReply } from \"@/services/chatApi\";\n\nexport default function ChatPage() {\n  const [messages, setMessages] = useState([\n    {\n      id: 1,\n      text: \"你好！我是你的天文助手，有什么可以帮助你的吗？\",\n      isUser: false,\n      time: \"14:30\",\n    },\n  ]);\n  const [inputText, setInputText] = useState(\"\");\n\n  const sendMessage = async () => {\n    if (inputText.trim()) {\n      const userMessage = {\n        id: messages.length + 1,\n        text: inputText,\n        isUser: true,\n        time: new Date().toLocaleTimeString(\"zh-CN\", {\n          hour: \"2-digit\",\n          minute: \"2-digit\",\n        }),\n      };\n\n      const updatedMessages = [...messages, userMessage];\n      setMessages(updatedMessages);\n      const currentInput = inputText;\n      setInputText(\"\");\n\n      try {\n        const data = await fetchChatReply(currentInput);\n        if (data) {\n          const aiMessage = {\n            id: updatedMessages.length + 1,\n            text: data.reply,\n            isUser: false,\n            time: new Date().toLocaleTimeString(\"zh-CN\", {\n              hour: \"2-digit\",\n              minute: \"2-digit\",\n            }),\n          };\n          setMessages((prevMessages) => [...prevMessages, aiMessage]);\n        }\n      } catch (error) {\n        console.error(\"Error fetching AI response:\", error);\n        const errorMessage = {\n          id: updatedMessages.length + 1,\n          text: \"抱歉，我这里出了点问题，暂时无法回复。\",\n          isUser: false,\n          time: new Date().toLocaleTimeString(\"zh-CN\", {\n            hour: \"2-digit\",\n            minute: \"2-digit\",\n          }),\n        };\n        setMessages((prevMessages) => [...prevMessages, errorMessage]);\n      }\n    }\n  };\n\n  return (\n    <div className=\"bg-black text-white min-h-screen flex flex-col\">\n      <div className=\"relative z-10 flex flex-col h-screen bg-black\">\n        {/* 顶部导航 */}\n        <div className=\"flex justify-between items-center p-4 border-b border-white/10 glass-effect\">\n          <Link\n            href=\"/\"\n            className=\"flex items-center space-x-2 text-blue-400 hover:text-blue-300 transition-colors\"\n          >\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              className=\"h-5 w-5\"\n              viewBox=\"0 0 20 20\"\n              fill=\"currentColor\"\n            >\n              <path\n                fillRule=\"evenodd\"\n                d=\"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z\"\n                clipRule=\"evenodd\"\n              />\n            </svg>\n            <span>返回</span>\n          </Link>\n          <h1 className=\"text-xl font-semibold\">天文助手</h1>\n          <div className=\"w-12\"></div>\n        </div>\n\n        {/* 聊天消息区域 */}\n        <div className=\"flex-1 overflow-y-auto p-4 space-y-6\">\n          {messages.map((message) => (\n            <div\n              key={message.id}\n              className={`flex items-end gap-2 ${message.isUser ? \"justify-end\" : \"justify-start\"\n                }`}\n            >\n              {!message.isUser && (\n                <div className=\"w-8 h-8 rounded-full bg-gradient-to-br from-purple-600 to-blue-500 flex-shrink-0\"></div>\n              )}\n              <div\n                className={`max-w-xs lg:max-w-md px-4 py-3 rounded-2xl ${message.isUser\n                  ? \"bg-blue-600/80 text-white rounded-br-lg\"\n                  : \"bg-gray-700/70 text-white rounded-bl-lg\"\n                  } glass-effect`}\n              >\n                <p className=\"text-base\">{message.text}</p>\n                <p\n                  className={`text-xs mt-2 text-right ${message.isUser ? \"text-blue-100/70\" : \"text-gray-400/70\"\n                    }`}\n                >\n                  {message.time}\n                </p>\n              </div>\n              {message.isUser && (\n                <div className=\"w-8 h-8 rounded-full bg-gray-600 flex-shrink-0\"></div>\n              )}\n            </div>\n          ))}\n        </div>\n\n        {/* 输入区域 */}\n        <div className=\"p-4 border-t border-white/10 glass-effect\">\n          <div className=\"flex space-x-4 items-center\">\n            <input\n              type=\"text\"\n              value={inputText}\n              onChange={(e) => setInputText(e.target.value)}\n              onKeyPress={(e) => e.key === \"Enter\" && sendMessage()}\n              placeholder=\"输入你的问题...\"\n              className=\"flex-1 bg-gray-800/80 text-white px-4 py-3 rounded-xl border border-gray-600/50 focus:outline-none focus:ring-2 focus:ring-blue-500/50 transition-all\"\n            />\n            <button\n              onClick={sendMessage}\n              className=\"bg-blue-600 text-white px-6 py-3 rounded-xl hover:bg-blue-700 transition-colors glow-effect disabled:opacity-50\"\n              disabled={!inputText.trim()}\n            >\n              发送\n            </button>\n          </div>\n        </div>\n\n        {/* 底部导航栏 */}\n        <FooterBar />\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}